<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Timetable Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Global styles and theming helpers -->
    <style>
      :root {
        color-scheme: light dark;
      }

      * {
        transition: background-color 0.3s ease, color 0.3s ease,
          border-color 0.3s ease;
      }

      body {
        font-family: 'Inter', Arial, sans-serif;
        min-height: 100vh;
        background-repeat: no-repeat;
        background-size: cover;
        background-attachment: fixed;
      }

      body.light-mode {
        background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        color: #1f2937;
      }

      body.dark-mode {
        background: linear-gradient(135deg, #111827 0%, #1f2937 100%);
        color: #e5e7eb;
      }

      .card {
        border: 1px solid;
        border-color: rgba(75, 85, 99, 0.3);
      }

      body.light-mode .card {
        background: rgba(255, 255, 255, 0.95);
        border-color: rgba(229, 231, 235, 0.8);
      }

      body.dark-mode .card {
        background: rgba(17, 24, 39, 0.95);
        border-color: rgba(75, 85, 99, 0.4);
      }

      .mode-toggle,
      .back-btn {
        border: 1px solid rgba(75, 85, 99, 0.4);
      }

      body.light-mode .mode-toggle,
      body.light-mode .back-btn {
        background: #e5e7eb;
        color: #1f2937;
        border-color: #d1d5db;
      }

      body.dark-mode .mode-toggle,
      body.dark-mode .back-btn {
        background: #374151;
        color: #93c5fd;
        border-color: #4b5563;
      }

      .mode-toggle:hover,
      .back-btn:hover {
        opacity: 0.9;
      }
    </style>
  </head>

  <body class="dark-mode">
    <!-- Public Timetable Hub (no authentication) -->
    <div class="max-w-5xl mx-auto p-6">
      <header
        class="flex items-start sm:items-center justify-between gap-4 mb-8 flex-col sm:flex-row"
      >
        <div>
          <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight">
            Timetable Hub
          </h1>
          <p class="opacity-80 mt-1">
            Browse your timetables. Hub is public; each timetable is protected.
          </p>
        </div>
        <div class="flex gap-2">
          <button id="mode-toggle" class="mode-toggle px-3 py-2 rounded-md">
            ☀️
          </button>
          <button
            class="back-btn px-3 py-2 rounded-md"
            onclick="history.back()"
            title="Go Back"
          >
            &larr; Back
          </button>
        </div>
      </header>

      <section
        id="timetable-list"
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"
      >
        <!-- Cards injected by JS -->
      </section>

      <footer class="mt-10 text-sm opacity-70">
        &copy; Robs Hub — Timetables directory
      </footer>
    </div>

    <!-- Theme manager (updates mode classes and toggle icons) -->
    <script src="../assets/theme.js"></script>

    <!-- Hub data and rendering -->
    <script>
      // Render hub cards from timetables.json (fallback to econ)
      async function loadTimetablesHub() {
        const container = document.getElementById('timetable-list');
        try {
          const res = await fetch('timetables.json', { cache: 'no-store' });
          if (!res.ok) throw new Error('Failed to load list');
          const data = await res.json();
          renderHubCards(data);
        } catch (e) {
          renderHubCards([
            {
              file: 'econ.html',
              title: 'Economics Timetable',
              description: 'First-class focus weekly schedule.',
            },
          ]);
        }
      }

      function renderHubCards(items) {
        const container = document.getElementById('timetable-list');
        container.innerHTML = '';

        if (!items || !items.length) {
          container.innerHTML =
            '<p class="opacity-80">No timetables available yet.</p>';
          return;
        }

        items.forEach((item) => {
          const a = document.createElement('a');
          a.href = item.file;
          a.className =
            'card block rounded-lg p-5 border hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-blue-400';
          a.innerHTML = `
            <h2 class="text-xl font-bold mb-1">${item.title || 'Untitled Timetable'}</h2>
            ${item.description ? `<p class="opacity-80 text-sm mb-3">${item.description}</p>` : ''}
            <span class="inline-flex items-center gap-1 text-blue-400">Open <span aria-hidden="true">→</span></span>
          `;
          container.appendChild(a);
        });
      }

      document.addEventListener('DOMContentLoaded', loadTimetablesHub);
    </script>
  </body>
</html>
  